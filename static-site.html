<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <link rel="stylesheet" href="./styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>

  <body>
    <div class="content">
      <header id="banner">
        <img class="avatar" src="http://i.imgur.com/r3v4S9O.jpg">
      </header>
      <section id="content" class="body">
        <a href="./index.html">&lt;</a>
        <time class="published">
        2016-04-24
        </time>
        <h1>
        The magic of static
        </h1>
        <div class="entry-content">
        <p>How do static site generators work?
That&#39;s the question I had when I began building my own
<a href='https://github.com/ngzhian/ocs'>static site generator</a>
for learning purposes.</p>
<p>With over 100 static site generatores listed on 
<a href='https://www.staticgen.com/'>staticgen.com</a>,
there must be something interesting going on there.</p>
<p>This post looks at a 2 popular static site generators,
<a href='https://jekyllrb.com/'>Jekyll</a> and <a href='https://jaspervdj.be/hakyll/'>Hakyll</a>,
and dig into their inner workings.</p>
<h2 id="Jekyll">Jekyll</h2>

<blockquote><p>Build a <code>Configuration</code>, create a <code>Site</code>, call <code>Reader</code>, run <code>Generator</code>, run <code>Converter</code>, write to disk.</p>
</blockquote>

<p>Jekyll is really easy to use,
you install the gem, run Jekyll from the command line,
and it will generate your site into
the <code>_site</code> folder.</p>
<pre><code>$ jekyll build</code></pre>

<p>The <code>build</code> command is found in <a href='https://github.com/jekyll/jekyll/blob/master/lib/jekyll/commands/build.rb'><code>build.rb</code></a>.
There are 3 top level steps are:</p>
<ol><li>Build a <code>Configuration</code></li><li>Initialize a <code>Site</code> with configuration</li><li>Calls <code>process</code> on <code>Site</code> object</li></ol>

<p>In this single command we see the 2 most important classes in Jekyll:
<a href='https://github.com/jekyll/jekyll/blob/master/lib/jekyll/configuration.rb'><code>Configuration</code></a>
and
<a href='https://github.com/jekyll/jekyll/blob/master/lib/jekyll/site.rb'><code>Site</code></a>.</p>
<p>A <code>Configuration</code> specifies where to find your files, plugins, layouts, data, where to write output, etc.</p>
<p>A <code>Site</code> is the orchestrator object that knows how to call other classes to build a site.
The <em>main</em> method of <code>Site</code> is <code>process</code>, and it shows clearly the steps taken.</p>
<ol><li><code>reset</code></li><li><code>read</code></li><li><code>generate</code></li><li><code>render</code></li><li><code>cleanup</code></li><li><code>write</code></li><li><code>print_stats</code></li></ol>

<p>Let&#39;s dive deeper in to some of the more interesting methods.</p>
<h3 id="read"><code>read</code></h3>

<p>Jekyll knows about different kinds of files, such as layout, data, collections, posts, pages.
The class that does this work is <a href='https://github.com/jekyll/jekyll/blob/master/lib/jekyll/reader.rb'><code>Reader</code></a>.
Each of this file has a specialized class to take care of finding the file and reading it,
for example <code>PostReader</code>, <code>DataReader</code>, <code>PageReader</code>, etc. They can be found in <a href='https://github.com/jekyll/jekyll/tree/master/lib/jekyll/readers'><code>readers</code></a>.
File contents are read into attributes on the <code>Site</code> object.</p>
<h3 id="render"><code>render</code></h3>

<p><a href='https://github.com/jekyll/jekyll/blob/master/lib/jekyll/renderer.rb'><code>Renderer</code></a>
takes the file contents read in by the readers and run them through converters.
Converters can do things like convert markdown to html, or render templates using liquid renderer.</p>
<h3 id="Plugins">Plugins</h3>

<p><a href='https://github.com/jekyll/jekyll/blob/master/lib/jekyll/plugin_manager.rb'><code>PluginManager</code></a>
uses ruby&#39;s require feature to load plugins from <code>_plugins</code>, as gems specified in <code>_config.yml</code>, or gems specified in <code>Gemfile</code>. Plugins are initialized when initializing <code>Site</code>.</p>
<p>To write a plugin, you can extend various Jekyll base classes, such as <code>Generator</code>, <code>Converter</code>, and implementing some methods.</p>
<h2 id="Hakyll">Hakyll</h2>

<p><em>coming soon</em></p>

        </div>
      </section>
      <footer>
      Powered by <a href="https://github.com/ngzhian/ocs">ocs</a>, a static blog generator written in OCaml.
      </footer>
    </div>
  </body>
</html>
